<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 400">
  <defs>
    <linearGradient id="dataGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#667eea"/>
      <stop offset="100%" style="stop-color:#764ba2"/>
    </linearGradient>
    <linearGradient id="processGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#11998e"/>
      <stop offset="100%" style="stop-color:#38ef7d"/>
    </linearGradient>
    <linearGradient id="modelGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#ee0979"/>
      <stop offset="100%" style="stop-color:#ff6a00"/>
    </linearGradient>
    <linearGradient id="outputGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#4776E6"/>
      <stop offset="100%" style="stop-color:#8E54E9"/>
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="3" stdDeviation="2" flood-opacity="0.15"/>
    </filter>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#64748b"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="800" height="400" fill="#f8fafc"/>

  <!-- Title -->
  <text x="400" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#1e293b">Data Flow Pipeline</text>

  <!-- Stage labels -->
  <text x="90" y="70" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#64748b">RAW DATA</text>
  <text x="270" y="70" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#64748b">TOKENIZE</text>
  <text x="450" y="70" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#64748b">TRAIN</text>
  <text x="630" y="70" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#64748b">INFERENCE</text>

  <!-- Raw Data Sources -->
  <g transform="translate(30, 90)">
    <rect width="120" height="40" rx="6" fill="url(#dataGrad)" filter="url(#shadow)"/>
    <text x="60" y="26" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white">TinyStories</text>
  </g>

  <g transform="translate(30, 145)">
    <rect width="120" height="40" rx="6" fill="url(#dataGrad)" filter="url(#shadow)"/>
    <text x="60" y="26" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white">Code Corpus</text>
  </g>

  <g transform="translate(30, 200)">
    <rect width="120" height="40" rx="6" fill="url(#dataGrad)" filter="url(#shadow)"/>
    <text x="60" y="26" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white">Tool Examples</text>
  </g>

  <!-- Arrows to Tokenizer -->
  <path d="M150 110 L180 110 L180 165 L200 165" stroke="#64748b" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <path d="M150 165 L200 165" stroke="#64748b" stroke-width="2" fill="none"/>
  <path d="M150 220 L180 220 L180 165 L200 165" stroke="#64748b" stroke-width="2" fill="none"/>

  <!-- Tokenizer -->
  <g transform="translate(210, 120)">
    <rect width="120" height="90" rx="8" fill="url(#processGrad)" filter="url(#shadow)"/>
    <text x="60" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="white">Tokenizer</text>
    <text x="60" y="50" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="rgba(255,255,255,0.9)">BPE</text>
    <text x="60" y="65" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="rgba(255,255,255,0.9)">32K vocab</text>
    <text x="60" y="80" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="rgba(255,255,255,0.9)">Text â†’ IDs</text>
  </g>

  <!-- Arrow to Model -->
  <path d="M330 165 L380 165" stroke="#64748b" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>

  <!-- Model Training -->
  <g transform="translate(390, 100)">
    <rect width="120" height="130" rx="8" fill="url(#modelGrad)" filter="url(#shadow)"/>
    <text x="60" y="25" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="white">Model</text>
    <text x="60" y="45" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="rgba(255,255,255,0.9)">Transformer</text>
    <text x="60" y="60" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="rgba(255,255,255,0.8)">1.6B params</text>
    <line x1="20" y1="70" x2="100" y2="70" stroke="rgba(255,255,255,0.3)" stroke-width="1"/>
    <text x="60" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="rgba(255,255,255,0.9)">Stage 1: Language</text>
    <text x="60" y="100" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="rgba(255,255,255,0.9)">Stage 2: Code</text>
    <text x="60" y="115" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="rgba(255,255,255,0.9)">Stage 3: Tools</text>
  </g>

  <!-- Arrow to Inference -->
  <path d="M510 165 L560 165" stroke="#64748b" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>

  <!-- Inference -->
  <g transform="translate(570, 120)">
    <rect width="120" height="90" rx="8" fill="url(#outputGrad)" filter="url(#shadow)"/>
    <text x="60" y="25" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="white">Inference</text>
    <text x="60" y="45" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="rgba(255,255,255,0.9)">Generation</text>
    <text x="60" y="60" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="rgba(255,255,255,0.9)">Tool Calling</text>
    <text x="60" y="75" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="rgba(255,255,255,0.9)">API Serving</text>
  </g>

  <!-- Output -->
  <path d="M690 165 L720 165" stroke="#64748b" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <g transform="translate(730, 140)">
    <rect width="50" height="50" rx="6" fill="#e2e8f0" stroke="#cbd5e1" stroke-width="2"/>
    <text x="25" y="22" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#475569">Code</text>
    <text x="25" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#475569">Output</text>
  </g>

  <!-- File paths -->
  <g transform="translate(30, 280)">
    <rect width="740" height="90" rx="8" fill="#f1f5f9" stroke="#e2e8f0"/>
    <text x="20" y="25" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#475569">File Locations:</text>

    <text x="20" y="50" font-family="monospace" font-size="11" fill="#1e293b">data/raw/*.txt</text>
    <text x="20" y="65" font-family="Arial, sans-serif" font-size="10" fill="#64748b">Raw text files</text>

    <text x="200" y="50" font-family="monospace" font-size="11" fill="#1e293b">data/tokenizer/</text>
    <text x="200" y="65" font-family="Arial, sans-serif" font-size="10" fill="#64748b">tokenizer.json</text>

    <text x="380" y="50" font-family="monospace" font-size="11" fill="#1e293b">data/processed/*.npy</text>
    <text x="380" y="65" font-family="Arial, sans-serif" font-size="10" fill="#64748b">Token arrays</text>

    <text x="570" y="50" font-family="monospace" font-size="11" fill="#1e293b">models/*.pth</text>
    <text x="570" y="65" font-family="Arial, sans-serif" font-size="10" fill="#64748b">Checkpoints</text>
  </g>
</svg>
